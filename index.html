<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="base.css">
  </head>
  <body class="home">
    <h1>Tech for Social Good Day <br> </h1>

    <p>Intro to T4SGD<br>
    </p>
    <p>
      Join ITP on January 31 @ 6-9 pm for a kickoff reception and February 1 @ 10am - 5:30 pm for a full day of workshops, discussions and talks. <br> This conference is organized by Tech & Society, a student club at ITP and sponsored by ITP and Tisch GSO. <br> This website is designed by Lydia Jessup.
    </p>

    <a class="fullwidth" href="pages/schedule.html">Schedule</a>
    <a class="fullwidth" href="pages/about.html">About</a>
    <a class="fullwidth" href="pages/attending.html">Attending</a>

    <h4>All about this event:</h4>
    <div id="info-blocks">
    </div>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      let info = [];
      const infoWrapper = document.getElementById("info-blocks");

      const axiosArena = axios.create({
        baseURL: "https://api.are.na/v2/",
      });

      let loading = document.createElement("div");
      loading.className = "loading";
      loading.innerHTML = 'loading...';
      infoWrapper.appendChild(loading);

      axiosArena.defaults.headers.Authorization = 'Bearer ---' ;
      axiosArena.get("channels/t4sgd-website?per=100").then(response => {
        console.log(response);
        if (response.data && response.data.contents.length > 1) {
          infoWrapper.removeChild(loading);
          createInfo(response.data.contents);
        } else {

        }
      });

      function createInfo(infoData) {
        for (let i=0; i<infoData.length; i++) {
          //create block
          let block = document.createElement("div");
          block.className = "block";

          if (infoData[i].source) {
            block = document.createElement("a");
            block.className = "block";
            block.href = infoData[i].source.url;
            block.target = "_blank";
          }

          if (infoData[i].class === "Channel") {
            block = document.createElement("a");
            block.className = "channel";
            block.href = `https://are.na/${infoData[i].user.slug}/${infoData[i].slug}`;
            block.target = "_blank";

            console.log("channel appears");
          }

          //create image
          if (infoData[i].image && infoData[i].image) {
            const image = document.createElement("img");
            image.className = "image";
            image.src = infoData[i].image.square.url;
            block.appendChild(image);
          }
          //create title
          if (infoData[i].title) {
            const title = document.createElement("div");
            title.className = "title";
            title.innerHTML = infoData[i].title;
            block.appendChild(title);
          }

          //create text
          if (infoData[i].class === "Text") {
            const text = document.createElement("div");
            text.className = "text";
            text.innerHTML = infoData[i].content;
            block.appendChild(text);
          }

          infoWrapper.appendChild(block);
        }
      }
    </script>
  </body>
</html>
